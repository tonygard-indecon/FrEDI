<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact estimate years)."><title>Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact year estimates) — aggregate_impacts • FrEDI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact year estimates) — aggregate_impacts"><meta property="og:description" content="Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact estimate years)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FrEDI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-getting-started">Getting Started</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-getting-started">
    <a class="dropdown-item" href="../articles/About.html">About FrEDI</a>
    <a class="dropdown-item" href="../articles/manual.html">Installing &amp; Running FrEDI</a>
    <a class="dropdown-item" href="../articles/contributing.html">Contributing to FrEDI</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/References.html">Documentation</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/Example1.html">Example #1: Run FrEDI with default parameters</a>
    <a class="dropdown-item" href="../articles/Example2.html">Example #2: Run FrEDI_SV with default parameters</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USEPA/FrEDI">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact year estimates)</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/FrEDI/blob/HEAD/R/aggregate_impacts.R" class="external-link"><code>R/aggregate_impacts.R</code></a></small>
      <div class="d-none name"><code>aggregate_impacts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Summarize and aggregate impacts from FrEDI (calculate national totals, average across models, sum impact types, and interpolate between impact estimate years).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aggregate_impacts</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  aggLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"national"</span>, <span class="st">"modelaverage"</span>, <span class="st">"impactyear"</span>, <span class="st">"impacttype"</span><span class="op">)</span>,</span>
<span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"annual_impacts"</span><span class="op">)</span>,</span>
<span>  groupByCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sector"</span>, <span class="st">"variant"</span>, <span class="st">"impactYear"</span>, <span class="st">"impactType"</span>, <span class="st">"model_type"</span>, <span class="st">"model"</span>,</span>
<span>    <span class="st">"region"</span><span class="op">)</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>Data frame of results FrEDI (outputs from <code><a href="run_fredi.html">run_fredi()</a></code>)</p></dd>


<dt>aggLevels</dt>
<dd><p>Levels of aggregation at which to summarize data: one or more of <code>c("national", "modelAverage", "impactYear", "impactType", "all")</code>. Defaults to all levels (i.e., <code>aggLevels="all"</code>).</p></dd>


<dt>columns</dt>
<dd><p>Character vector of columns for which to aggregate results (defaults to <code>columns=c("annual_impacts"</code>)).</p></dd>


<dt>groupByCols</dt>
<dd><p>Character vector indicating which columns to use for grouping. Defaults to <code>groupByCols=c("sector", "variant", "impactYear", "impactType", "model_type", "model", "region")</code>. Note that the <code>"variant"</code> column referred to below contains information about the variant (or adaptation) name or <code>“N/A”</code>, as applicable.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The output of <code><a href="run_fredi.html">run_fredi()</a></code> is an R data frame object containing annual average impacts, by year (2010-2090), summarized at the specified aggregation and grouping levels.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This post-processing helper function aggregates and summarizes the FrEDI results to levels of aggregation specified by the user (passed to <code>aggLevels</code>). Users can specify a single aggregation level or multiple aggregation levels by passing a single character string or character vector to <code>aggLevels</code>. Options for aggregation include calculating national totals (<code>aggLevels="national"</code>), averaging across model types and models (<code>aggLevels="modelAverage"</code>), summing over all impact types (<code>aggLevels="impactType"</code>), and interpolating between impact year estimates (<code>aggLevels="impactYear"</code>). Users can specify all aggregation levels at once by specifying <code>aggLevels="all"</code> (default).
This post-processing helper function aggregates and summarizes temperature binning results to levels of aggregation specified by the user (passed to <code>aggLevels</code>). Users can specify a single aggregation level or multiple aggregation levels by passing a single character string or character vector to <code>aggLevels</code>. Options for aggregation include calculating national totals (<code>aggLevels="national"</code>), averaging across model types and models (<code>aggLevels="modelaverage"</code>), summing over all impact types (<code>aggLevels="impacttype"</code>), and interpolate between impact year estimates (<code>aggLevels="impactyear"</code>). Users can specify all aggregation levels at once by specifying <code>aggLevels="all"</code> (default) or no aggregation levels (<code>aggLevels="none"</code>).</p>
<p>Before aggregating impacts for national totals and/or model averages, <code>aggregate_impacts()</code> will drop any pre-summarized results  (i.e., values for which <code>region="National Total"</code> and/or for which <code>model="average"</code>, respectively) that are already present in the data `and then reaggregate at those levels.</p>
<p>For each of the <code>aggLevels</code>, <code>aggregate_impacts()</code> performs the following calculations (note that the <code>"variant"</code> column referred to below contains information about the variant (or adaptation) name or <code>“N/A”</code>, as applicable):</p>
<table class="table table"><tr><td><strong>Aggregation Level</strong></td><td><strong>Description</strong></td></tr><tr><td><code>national</code></td><td>Annual values are summed across all regions present in the data. I.e., data is grouped by columns <code>"sector"</code>, <code>"variant"</code>, <code>"impactType"</code>,  <code>"impactYear"</code>, <code>"model_type"</code>, <code>"model"</code>, and <code>"year"</code>) and summed across regions. Years which have missing column data for all regions return as <code>NA</code>. The rows of the data frame of national values (with column <code>region="National Total"</code>) are then added as rows to the results.</td></tr><tr><td><code>modelaverage</code></td><td>For temperature-driven sectors, annual results are averaged across all GCM models present in the data. I.e., data is grouped by columns <code>"sector"</code>, <code>"variant"</code>, <code>"impactType"</code>, <code>"impactYear"</code>, <code>"model_type"</code>, <code>"region"</code>, and <code>"year"</code> and averaged across models (SLR impacts are estimated as an interpolation between SLR scenarios). Averages exclude missing values. Years which have missing column data for all models return as <code>NA</code>. The rows of model averages (with column <code>model="Average"</code> are then added as rows to the results data frame.</td></tr><tr><td><code>impacttype</code></td><td>Annual results are summed across all impact types by sector present in the data. I.e., data is grouped by columns <code>"sector"</code>, <code>"variant"</code>, <code>"impactType"</code>, <code>"impactYear"</code>,<code>"model_type"</code>, <code>"model"</code>, <code>"region"</code>, and <code>"year"</code> and summed across impact types. Mutates column <code>impactType="all"</code> for all values. Years which have missing column data for all impact types return as <code>NA</code>. If results are aggregated across impact types, information about physical impacts (columns <code>"physicalmeasure"</code> and <code>"physical_impacts"</code>) are dropped.</td></tr><tr><td><code>impactyear</code></td><td>Annual results for sectors with only one impact year estimate (i.e., <code>impactYear = "N/A"</code>) are separated from those with multiple impact year estimates. Sectors with multiple impact years have separate results for impact years 2010 and 2090. For these sectors, annual results are linearly interpolated between impact year estimates. For any model run years above 2090, annual results for sectors with multiple impact years return the 2090 estimate. The interpolated values are bound back to the results for sectors with a single impact year estimate, and column <code>impactYear</code> set to <code>impactYear="Interpolation"</code> for all values.</td></tr></table><p>Note that <code>aggregate_impacts()</code> drops columns not used in grouping or aggregation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Environmental Protection Agency (EPA). 2021. Technical Documentation on The Framework for Evaluating Damages and Impacts (FrEDI). Technical Report EPA 430-R-21-004, EPA, Washington, DC. Available at <a href="https://epa.gov/cira/FrEDI/" class="external-link">https://epa.gov/cira/FrEDI/</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Create temperature binning scenario</span></span></span>
<span class="r-in"><span><span class="va">df_tempExOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="run_fredi.html">run_fredi</a></span><span class="op">(</span>aggLevels<span class="op">=</span><span class="st">"none"</span>, pv<span class="op">=</span><span class="cn">TRUE</span>, silent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking input values...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No temperature scenario provided...using default temperature scenario...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating SLR scenario from temperature scenario...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No GDP scenario provided...Using default GDP scenario...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating Population scenario from defaults...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting results...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Aggregate temperature binning summary across multiple columns</span></span></span>
<span class="r-in"><span><span class="va">agg_tempExOut</span> <span class="op">&lt;-</span> <span class="va">df_tempExOut</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">aggregate_impacts</span><span class="op">(</span>columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"annual_impacts"</span>, <span class="st">"discounted_impacts"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	Interpolating between impact year estimates...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	Calculating model averages...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	Calculating national totals...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	Summing across impact types...</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Corinne Hartin, Erin McDuffie, Karen Noiva.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7. | July 2023</p>
</div>

    </footer></div>

  

  

  </body></html>

